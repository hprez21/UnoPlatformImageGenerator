<Page x:Class="ImageGenerator.Presentation.SecondPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:ImageGenerator.Presentation"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:uen="using:Uno.Extensions.Navigation.UI"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:um="using:Uno.Material"
      Background="{ThemeResource BackgroundBrush}">

  <Grid Padding="24,24,0,0">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    
    <!-- Title Section -->
    <StackPanel Grid.Row="0" VerticalAlignment="Center" Spacing="8">
      <TextBlock Text="Select Options"
                 Style="{StaticResource HeadlineMedium}"
                 Foreground="{ThemeResource OnBackgroundBrush}"
                 FontWeight="Bold"/>
      <TextBlock Text="Minimum of 6 options"
                 Style="{StaticResource BodyLarge}"
                 Foreground="{ThemeResource OnSurfaceVariantBrush}"
                 Opacity="0.7"/>
    </StackPanel>
    
    <!-- Options Chips (Horizontal List) -->
    <ScrollViewer Grid.Row="1" 
                  HorizontalScrollBarVisibility="Hidden" 
                  HorizontalScrollMode="Enabled"
                  VerticalScrollMode="Disabled"
                  Margin="0,24,0,24">
      <ItemsRepeater x:Name="OptionsRepeater" ItemsSource="{Binding Options}">
        <ItemsRepeater.Layout>
          <StackLayout Orientation="Horizontal" Spacing="10"/>
        </ItemsRepeater.Layout>
        <ItemsRepeater.ItemTemplate>
          <DataTemplate>
            <Grid Height="50" Width="150" Tapped="OptionItem_Tapped">
              <Border x:Name="SelectionBorder"
                      CornerRadius="35"
                      Background="#242529"
                      BorderThickness="2"
                      BorderBrush="Transparent"/>
              <TextBlock Text="{Binding Name}" 
                         Style="{StaticResource BodyMedium}"
                         Foreground="White"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"/>
            </Grid>
          </DataTemplate>
        </ItemsRepeater.ItemTemplate>
      </ItemsRepeater>
    </ScrollViewer>
    
    <!-- Style Selection Title -->
    <TextBlock Grid.Row="2"
               Text="Choose a style of picture"
               Style="{StaticResource TitleLarge}"
               Foreground="{ThemeResource OnBackgroundBrush}"
               FontWeight="Bold"
               Margin="0,0,0,16"/>
    
    <!-- Art Styles Gallery -->
    <ScrollViewer Grid.Row="3" 
                  HorizontalScrollBarVisibility="Auto"
                  HorizontalScrollMode="Enabled"
                  VerticalScrollMode="Disabled"
                  Margin="0,0,-24,0">
      <ItemsRepeater x:Name="StylesRepeater" ItemsSource="{Binding Styles}">
        <ItemsRepeater.Layout>
          <StackLayout Orientation="Horizontal" Spacing="10"/>
        </ItemsRepeater.Layout>
        <ItemsRepeater.ItemTemplate>
          <DataTemplate>
            <Grid Width="180" Tapped="StyleItem_Tapped">
              <!-- Selection Border -->
              <Border x:Name="SelectionBorder"
                      CornerRadius="24"
                      BorderThickness="3"
                      BorderBrush="Transparent"
                      Padding="3"/>
              <Grid Margin="3">
                <Border CornerRadius="20">
                  <Border.Background>
                    <ImageBrush ImageSource="{Binding ImageUrl}" Stretch="UniformToFill"/>
                  </Border.Background>
                </Border>
                <!-- Shadow text behind -->
                <TextBlock Text="{Binding Name}"
                           Style="{StaticResource TitleSmall}"
                           Foreground="Black"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Bottom"
                           Margin="1,0,0,9"
                           Opacity="0.8"/>
                <!-- Main text -->
                <TextBlock Text="{Binding Name}"
                           Style="{StaticResource TitleSmall}"
                           Foreground="White"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Bottom"
                           Margin="0,0,0,10"/>
              </Grid>
            </Grid>
          </DataTemplate>
        </ItemsRepeater.ItemTemplate>
      </ItemsRepeater>
    </ScrollViewer>
    
    <!-- Prompt Editor -->
    <Border Grid.Row="4"
            Margin="0,24,24,16"
            CornerRadius="20"
            Background="#242529"
            MinHeight="120">
      <TextBox Text="{Binding PromptText, Mode=TwoWay}"
               PlaceholderText="Describe what you want to generate..."
               AcceptsReturn="True"
               TextWrapping="Wrap"
               Background="Transparent"
               BorderThickness="0"
               Foreground="{ThemeResource OnBackgroundBrush}"
               Padding="16"/>
    </Border>
    
    <!-- Generate Button -->
    <Button Grid.Row="5"
            Command="{Binding Generate}"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Width="150"
            CornerRadius="25"
            Background="#98C0FE">
      <TextBlock Text="Generate"
                 Style="{StaticResource TitleMedium}"
                 Foreground="Black"
                 FontWeight="SemiBold"/>
    </Button>
  </Grid>
</Page>
